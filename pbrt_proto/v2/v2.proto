syntax = "proto2";

import "pbrt_proto/pbrt.proto";

package pbrt_proto.v2;

// A directive which sets the Accelerator to use for rendering.
message Accelerator {
  // The type of Accelerator to use. If none are set, then `bvh` should be read
  // as if it is present.
  oneof accelerator_type {
    GridAccelerator grid = 1;  // Use a Grid accelerator
    KdTreeAccelerator kdtree = 2;  // Use a KD-tree accelerator
    BvhAccelerator bvh = 3;  // Use a BVH accelerator (default)
  }
}

// A directive which sets the current area light source.
message AreaLightSource {
  // The type of AreaLightSource. If none are set, then the current area light
  // source should be unset.
  oneof area_light_source_type {
    DiffuseAreaLightSourceV1 diffuse = 1;  // Use a diffuse area light
  }
}

// A directive which sets the current camera.
message Camera {
  // The type of camera to use. If none are set, then the current camera should
  // be unset. If no camera is set at the time an image is to be rendered a
  // black frame should be rendered.
  oneof camera_type {
    SphericalCamera environment = 1;  // Use a spherical camera
    OrthographicCamera orthographic = 2; // Use an orthographic camera
    PerspectiveCamera perspective = 3;  // Use a pespective camera
  }
}

// A directive which sets the Film to use for rendering
message Film {
  // The type of film to use. If none are set, then the current film should
  // be unset. If no camera is set at the time an image is to be rendered a
  // black frame should be rendered.
  oneof film_type {
    RgbFilm image = 1;  // Use an rgb film
  }
}

// A directive which sets the Camera to use for rendering.
message PixelFilter {
  // The type of PixelFilter to use. If none are set, then the current
  // PixelFilter should be unset. If no PixelFilter is set at the time an image
  // is to be rendered the renderer should exit with an error.
  oneof pixel_filter_type {
    BoxPixelFilter box = 1;  // Use a box filter
    GaussianPixelFilter gaussian = 2;  // Use a Gaussian filter
    MitchellPixelFilter mitchell = 3;  // Use a Mitchell-Netravali filter
    LanczosPixelFilter sinc = 4;  // Use a Lanczos filter
    TrianglePixelFilter triangle = 5;  // Use a triangle filter
  }
}

// A directive which sets the Sampler to use for rendering.
message Sampler {
  // A sampler which adaptively varies the number of samples per pixels.
  message AdaptiveSampler {
    // The maximum number of samples per pixel.
    optional uint32 maxsamples = 1 [default = 32];

    // The minimum number of samples per pixel.
    optional uint32 minsamples = 9 [default = 4];

    // The supported methods for adapting the number of samples per pixel.
    enum Method {
      CONTRAST = 0;
      SHAPEID = 1;
    }

    // The method to use to determine the number of samples per pixel.
    optional Method method = 10 [default = CONTRAST];
  }

  // The type of Sampler to use. If none are set, then the current Sampler
  // should be unset. If no Sampler is set at the time an image is to be
  // rendered a black frame should be rendered.
  oneof sampler_type {
    BestCandidateSampler bestcandidate = 1;  // Use a best candidate sampler
    ZeroTwoSequenceSampler lowdiscrepancy = 2;  // Use a 02-sequence sampler
    StratifiedSampler stratified = 4;  // Use a stratified sampler
    AdaptiveSampler adaptive = 5;  // Use an adaptive sampler
    IndependentSampler random = 6;  // Use a random sampler
    HaltonSampler halton = 7;  // Use a Halton sequence sampler
  }
}
